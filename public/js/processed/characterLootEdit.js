var inputType="string",firstRun=!0,addedCount=0,skippedCount=0,overLimitCount=0,skippedItems=[],errorCount=0,firstError=void 0;function clearImportInput(){$("[name=import_textarea]").val("")}function clearWishlistItems(){var t=$("#wishlist .js-input-button");disableForm(),$("#wishlistItems").find(".js-input-button").each(function(t){$(this).click()}),enableForm()}function enableForm(){setTimeout(function(){$("#itemForm fieldset").prop("disabled",!1),$("#loading-indicator").hide(),$("#loaded-indicator").show(),setTimeout(function(){$("#submitImport").prop("disabled",!1),$(".js-toggle-import").prop("disabled",!1),$("#loaded-indicator").hide()},5e3)},1e3)}function disableForm(){$("#loading-indicator").show(),$("#submitImport").prop("disabled",!0),$("#itemForm fieldset").prop("disabled",!0),$(".js-toggle-import").prop("disabled",!0)}function loadItemToForm(t){var e=$("#wishlist");addTag(e,t.id,t.name||null)}function parseUpgradesImport(t){if("true"!=$(t).prop("disabled")){disableForm(),$("#status-message").html("").hide(),errorCount=0,firstError=void 0,addedCount=0,overLimitCount=0,skippedItems=[],firstRun?firstRun=!1:console.log("--------------------------------------------------"),console.log('Input accepts JSON. eg. { "items": [ { "name": "Azuresong Mageblade", "id": 17103 }, { "name": "Staff of Dominance", "id": 18842 } ] }'),console.log("Importing wishlist items...");var e=$("#importTextarea").val();if(!e)return alert("Please enter a valid JSON string. Re-copy the export from 60/70/80 upgrades.com"),enableForm(),0;var i=null;try{i=JSON.parse(e)}catch(t){console.log("Invalid JSON input."),console.log("Clearing input... Old input:",$("[name=import_textarea]").val()),clearImportInput(),errorCount++,firstError="Invalid input. Try again."}if(!errorCount){var o;console.log(i),setTimeout(function(){},250);var n=null;if(i.items&&i.items.length>0?n=i.items:null!==(o=i.player)&&void 0!==o&&null!==(o=o.equipment)&&void 0!==o&&o.items&&(n=i.player.equipment.items),n&&n.length>0){for(var r=0;r<n.length;r++){var a=n[r];r>=maxItems?(overLimitCount++,skippedItems.push(a.name)):(loadItemToForm(a),addedCount++)}makeWowheadLinks()}else console.log("No items found")}var s="";if(firstError&&(s+='<li class="text-danger">Error: '.concat(firstError,"</li>")),addedCount&&(s+='<li class="text-success">'.concat(addedCount," item").concat(addedCount>1?"s":""," loaded into form</li>")),overLimitCount&&(s+='<li class="text-warning">'.concat(overLimitCount?overLimitCount+" items over the limit of "+maxItems:"","</li>")),skippedItems.length){var l=skippedItems.length;skippedItems=skippedItems.join(", "),s+='<li class="text-danger">'.concat(l," item").concat(l>1?"s":""," skipped (no room): ").concat(skippedItems,"</li>")}addedCount&&(s+='<li class="text-warning font-weight-bold">Review your wishlist and then save it</li>'),s&&$("#status-message").html("<ul>".concat(s,"</ul>")).show(),clearImportInput(),setTimeout(function(){enableForm()},100)}}$(document).ready(function(){var t=!0;warnBeforeLeaving("#itemForm"),addSortHandlers(),$(".js-toggle-import").click(function(){$("#toggleImport").toggle(),$("#importArea").toggle()}),$("[name=import_textarea]").bind("input change",function(){$(this).val()?$("#submitImport").prop("disabled",!1):$("#submitImport").prop("disabled",!0)}),$("#submitImport").click(function(){parseUpgradesImport(this)}),$(".js-toggle-note").change(function(){var t=$(this).data("index"),e=$(this).data("type");$(this).prop("checked")?$(".js-note[data-index="+t+"][data-type="+e+"]").parent().show():$(".js-note[data-index="+t+"][data-type="+e+"]").parent().hide()}),$("#clearWishlist").click(function(){clearWishlistItems()}),t=!1,$(".loadingBarContainer").removeClass("d-flex").hide(),$("#itemForm").show()});
